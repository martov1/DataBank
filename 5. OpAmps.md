**Fuentes teoricas copadas**
[Electronics 1 - topic 2 - Opamp circuit analysiis](https://www.youtube.com/watch?v=vlxjpEWlFKU&list=PLZvLSclgk4yIB77KiJ_1ArndvqaB6q0C4)
[Electronics 1 - topic 3 - OpAmps limitations](https://www.youtube.com/watch?v=HyIx2OslKz0&list=PLZvLSclgk4yKWOjmSVRqFXXHSY4d4p0_H)
[Electronics 3 - Topic 1 - OpAmp review and circuits](https://www.youtube.com/watch?v=D2x9Et7OffE&list=PLZvLSclgk4yJ8KtSQUtaerM1oVFKj7Ygs)
[Electronics 3 - Topic 2 - Linear OpAmp Circuits](https://www.youtube.com/watch?v=PtVhsodqbCM&list=PLZvLSclgk4yJVnTNwD9CFaYCRUuLGCDcP)


# Introduccion

Se trata de un circuito integrado hecho con transistores que funciona como amplificador. 

* **Acerca de la alimentacion:**
	* Suele necesitar alimentacion positiva y negativa $+V_{cc}$ y $-V_{cc}$
* **Acerca de las entradas:**
	* Las entradas son dos y son llamadas 
		* **Inversora** $V_i$
		* **No inversora** V_{ni}
	* **La impedancia** de las entradas es tan grande que puede ser considerada  entrada casi infinita
		* **La corriente de entrada** entonces es **despreciable**!
* **Acerca de la amplificacion:**
	* **La ganancia** que tiene  **es inmensa** (ej 100.000 veces)
	* **Amplifica el** $\Delta V$ entre las dos terminales de entrada
	* **Puede amplificar hasta llegar** a valores de alimentacion $+V_{cc}$ y $-V_{cc}$
	* **la amplificacion es lineal**


![](https://i.imgur.com/CM3sG3a.png)

$$\huge{\boxed{V_{salida}=(V_{ni}-V_i)*A}}$$


![](https://i.imgur.com/RyXDCq4.png)

Vemos como el amplificador amplifica hasta llegar a $+-V_{cc}$ y **luego satura**
![](https://i.imgur.com/luOZJq2.png)
## El comparador
### Comparador - Concepto
[fuente](https://www.youtube.com/watch?v=-_WmaX8leYY&t=2s)

Puedo aprovechar las capacidades de amplficacion infinita del OpAmp para **comparar dos señales** y devolver
* Una señal positiva si $V_i>V_{ni}$
* Una señal negativa si $V_i<V_{ni}$
* El caso $V_i\approx V_{ni}$ lo ignoramos, por que tienen que ser **super** iguales


El funcionamiento esta basado en la equacio de la señal de salida

$$\large{\boxed{V_{salida}=(V_{ni}-V_i)*A}}$$

Vemos que:
* Como $A$ es enorme, con poquita $\Delta V$ ya el OpAmp va a saturar
	* Entonces ignoramos la region lineal por completo!
	* ![](https://i.imgur.com/sMF3LVN.png =300x )
* Como el OpAmp seguro va a saturar, va a darme salidas de valor $V_{++}$ o $V_{--}$

[ejemplo](https://tinyurl.com/yaclmfgk)
![](https://i.imgur.com/ofVJABJ.png)

Algunos valores de ejemplo
![](https://i.imgur.com/v4ubUmi.png)
### Comparador y sensores
[fuente](https://www.youtube.com/watch?v=-_WmaX8leYY&t=2s)

Funciona bajo el mismo principio que el comparador.
La idea es que si tengo un sensor resistivo, puedo usarlo como parte de un **divisor de tension** para  lograr un voltaje determinado cuando senso cierto valor fisico.

Luego armo un divisor de tension en la otra alimentacion que de el mismo valor de voltaje

Ahora si el sensor esta por abajo de ese valor, tiene menos resistencia y por ende menos tension, entonces el OpAmp da FALSE.

Si el sensor esta arriba de ese valor, tiene mas resistencia y por ende mas tension, entonces el OpAmp da TRUE
[ejemplo](https://tinyurl.com/y7r5zhxa)
![](https://i.imgur.com/AXGrUIf.png)
## Comparador con histeresis / schmitt trigger

### Introduccion
[fuente](https://www.youtube.com/watch?v=uJx3hhfMvUk)
[fuente 2](https://www.youtube.com/watch?v=9HpYxT1IYXk&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=114)
Se trata de un circuito que cambia su salida cuando la **entrada esta por encima o por debajo de cierta franja.**

Esto permite **digitalizar una señal analogica y ser inmune al ruido**, ya que una vez que subimos por encima de cierto nivel $V_{upper-threshhold}$, la salida no cambiara hasta que la señal baje por debajo de $V_{lower-threshold}$ y viceversa

![](https://i.imgur.com/l4nYw20.png)
Esto se logra **dividendo la salida de un OpAmp en saturacion en dos con un divisor de tension y enviandolo a la entrada no inversora**.


[ejemplo](https://tinyurl.com/yep5au7h)
![](https://i.imgur.com/ZprF4cC.png)

Cuando 
$$V_{in}>\frac{V_{cc}}{2}$$

El OpAmp satura para el otro lado y cambia cuando

$$V_{in}<\frac{-V_{cc}}{2}$$

Esto se ve claramente con un grafico que compara la entrada con la salida, que es el motivo del simbolo caracteristico del schmitt trigger.

![](https://i.imgur.com/V5ybZzF.png)
_Simbolo caracteristco_
![](https://i.imgur.com/Iukjpsv.png)
### Parametros esenciales
[fuente](https://www.youtube.com/watch?v=9HpYxT1IYXk&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=114)

Podemos varar dos parametros de nuestro **schmitt trigger** que nos permiten controlar **todo su comportamiento**

* $\Delta H$ la distancia entre los threshholds. osea 
	* $\Delta H=|V_{thMax}-V_{thMin}|$
	* ![](https://i.imgur.com/TiJZRFQ.png =500x)
* $\Delta M$ el punto intermedio entre ambos threshholds
	* ![](https://i.imgur.com/PUwZWYY.png =500x)
* $+V_{out} \text{ y } -V_{out}$ las tensiones a la salida de el schmitt trigger, por ejemplo $10V$ y $-10V$ ó $5V$ y $0V$ 
	* No son mas que las **dos alimentaciones del OpAmp** 

**EJEMPLO:**
Queremos un schmtt trigger que
* Encienda un motor con una salida de $+V_{out}10V$ cuando la señal de entrada $V_{in}$este encima de $V_{thMax}=5V$
* Invierta su giro con una salida de $-V_{out}=-10V$ cuando la señal de entrada este debajo de $V_{thmin}=1V$ tendriamos

**Estas caracteristicas implicarian un trigger que**
*	$\Delta H = 5-1=4V$
* $\Delta M = 3V$
* $+V_{max}=10V;-V_{max}=-10V$
![](https://i.imgur.com/fIQCJhk.png)
### Calculo

#### $\Delta H$	
[fuente](https://www.youtube.com/watch?v=9HpYxT1IYXk&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=114)
[fuente 2](https://www.youtube.com/watch?v=uJx3hhfMvUk)
**Podemos controlar** $\Delta H$Modificando el divisor de tension $R_1$ y $R_2$	
[ejemplo](https://tinyurl.com/yz974ys9)
![](https://i.imgur.com/5vKUaBA.png =500x)
$$\large{\boxed{\Delta H = 2V_{cc} \frac{R2}{R_1+R_2}}}$$

**Derivacion:**
*  **Cambiar el divisor de tension** cambia la caida $V_{R2}$ entre la salida del OpAmp y la retroalimentacion positiva
	*  Entonces desfasa la salida del OpAmp $V_{out}$ con respecto a  comparacion entre $V_{in} \text{ y } V_{r2}$
* Esto hace que puedas setear cualquier $\Delta H$ entre los valores de alimentacion del OpAmp
* [ejemplo](https://tinyurl.com/yz974ys9)
![](https://i.imgur.com/0UgVVFb.png) 
#### $\Delta M$ 
 [fuente](https://www.youtube.com/watch?v=9HpYxT1IYXk&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=114)
Para desfasar $\Delta M$ lo que hacemos es **poner una fuente de tension en lugar de una tierra.** De esta manera la caida de una punta del divisor de corrientee a la otra sera de 

$$V_{out}-V_{fuente}$$

Entonces la caida del divisor de tension es 


$$V_{r2} =(V_{out}-V_{fuente}) \frac{R2}{R_1+R_2}$$

Entonces cuando el OpAmp compara $V_{r2}$ con $V_{in}$, estaran desfasados! este offset te genera el cambio en $\Delta M$.

![](https://i.imgur.com/YOunSSg.png)
Entonces **modificando el valor de esa fuente offseteamos la comparacion y modificamos**  $\Delta M$

![](https://i.imgur.com/dtQS3GP.png)![](https://i.imgur.com/1ygWEOy.png)
#### Conclusion
[fuente](https://www.youtube.com/watch?v=9HpYxT1IYXk&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=114)
Combinando ambos circuitos precedentes podemos cambiar $\Delta H$ y $\Delta M$ a nuestro antojo y lograr que el schmitt trigger tenga los $V_{thmax}$ y $V_{thmin}$ que nosotros queramos

[ejemplo](https://tinyurl.com/ydrgec7j)
![](https://i.imgur.com/4xUlU1N.png)

# Feedback negativo 

## + Introduccion - El buffer
[fuente](https://www.youtube.com/watch?v=-Zj-AaTd69c)
[fuente - Preciosa explicacion del feedback negativo](https://www.youtube.com/watch?v=7OuUiwI8fDk&list=PLL_nf1OmixTTd7rEoqoM6aJ5ZdI-V47vs)
[fuente - feedback negativo](https://www.youtube.com/watch?v=-Zj-AaTd69c)
### Nociones
[fuente - Preciosa explicacion del feedback negativo](https://www.youtube.com/watch?v=7OuUiwI8fDk&list=PLL_nf1OmixTTd7rEoqoM6aJ5ZdI-V47vs)
[fuente - El buffer](https://www.youtube.com/watch?v=sYB61zXu9EE&list=PLL_nf1OmixTTd7rEoqoM6aJ5ZdI-V47vs&index=4)

>**Utilidad:**
>Permite usar el OpAmp para bajarle la impedancia a una señal, por ejemplo a una que venga de un sensor


Podemos tener una tension de salida igual a la tension de entrada mediante la tecnica de **feedback negativo**

El circuito es simple, se conecta el OpAmp como se muestra en la imagen, la salida sera igual a la entrada pero con **menor impedancia**, es decir que podemos alimentar una carga decente con esa salida. 

>Este fenomeno tambien a veces se describe como
_El OpAmp genera la salida que haga falta para que **las dos entradas sean iguales**_
>Esta afirmacion habla de el opamp cuando esta usado en negative feedback.

![](https://i.imgur.com/JQyJwlz.png)
### Fundamento de funcionamiento
[fuente](https://www.youtube.com/watch?v=-Zj-AaTd69c)
**El principio de funcionamiento del feedback es el siguiente:**

* $V_{in}$ tiene un valor, $V_{i}$ por el momento no tiene valor osea $V_{in}>V_i$
	* El OpAmp genera una **salida positiva**
* $V_i$ ahora tiene una salida positiva saturada, osea que $V_{in}>V_i$
	*  El OpAmp genera una **salida positiva**
* Este proceso se repite cada vez que $V_{i}$ cruza el valor de $V_{in}$, eventualmente **se estabilizan en el mismo valor**

**Como consecuencia:**
$$\huge{\boxed{V_i=V_{in}}}$$

>Este fenomeno tambien a veces se describe como
_El OpAmp genera la salida que haga falta para que **las dos entradas sean iguales**_

![](https://i.imgur.com/mHGYWTN.png)
En una simulacion, con la resolucion adecuadad, se puede ver como lo que parece una tension continua **es en realidad un baile infinito que baja y sube de la tension objetivo**.
[Simulacion](https://tinyurl.com/ybakhpr6)

![](https://i.imgur.com/V2AnqgF.png)
**Fundamento numerico**
[fuente](https://www.youtube.com/watch?v=-Zj-AaTd69c)
1. Recordamos que:  $V_{salida}=(V_{ni}-V_i)*A$
2. Pero vemos que $V_{salida}=V_{i}$, por que estan conectados por un cable en nuestro circuito
3. Reemplazando: $V_{salida}=(V_{ni}-V_{salida})*A$ 
4. Esto se puede masajear llegando a $\frac{V_{salida}}{V_{ni}}=\frac{A}{A+1}$ 
5. Como $A\to \infty$ entonces $\frac{V_{salida}}{V_{ni}}=\frac{A}{A+1} \approx 1$
6. Como  $\frac{V_{salida}}{V_{in}}$ es la definicion de **gain**, $A=1$
* 
### Aplicacion 1: Uso de volajes de referencia

[fuente](https://www.youtube.com/watch?v=sYB61zXu9EE&list=PLL_nf1OmixTTd7rEoqoM6aJ5ZdI-V47vs&index=4)
Podemos tomar un voltaje de referencia y transformarlo en una fuente util de tension para accionar transistores u otros elementos que consumen pequeñas corrientes


![](https://i.imgur.com/EyY9uLo.png)


### Aplicacion 2: Fuente estabilizada de valor fijo
[fuente 1](https://www.youtube.com/watch?v=uxxlq9qSkZo&list=PLL_nf1OmixTTKhw2oVBtCZUYoMecz-YW5&index=4)
[fuente 2](https://www.youtube.com/watch?v=BPiTDtXN40c&t=542s)

Para **evitar la desventaja de baja precision de la fuente con transistor**, podemos usar un OpAmp.


Por Negative feedback, el OpAmp va a regular la tension de salida, compensando por negative feedback el problema que tiene el transistor de que  su caida de tension $V_{be}$ varia entre $0.3V-0.7V$ con los cambios de $I_b$.

**El OpAmp variara su salida para compensar esos cambios** de $V_{be}$, ya que siempre intenta compensar $V_b$, que esta conectada con la entrada inversora, con $V_z$ que esta conectada con la entrada no inversora.




[Ejemplo](https://tinyurl.com/yhljkje6)
![](https://i.imgur.com/CaBOpv4.png)
Notese que como concecuencia **la caida** $V_{be}$ **del transistor desaparece** por que el opamp **compensa esa caida proveyendo tension extra** para lograr que $V_{i}=V_{ni}$

![](https://i.imgur.com/2BhuAjC.png)

### Aplicacion 3: fuente de corriente BJT mejorada

#### Funcionamiento

[fuente](https://www.youtube.com/watch?v=VyCq7cXjXK8&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=125)

Su funcionamiento es identico al funcionamiento de la **fuente de corriente constante por BJT**, su unica vetaja es que permite indicar la señal de corriente deseada mediante un divisor de tension a traves del que pase poca corriente, ya que el OpAmp tiene impedancia infinita.


[ejemplo](https://tinyurl.com/yfj9tgtn)![](https://i.imgur.com/1T5vW4p.png)

**Funcionamiento**
1. Selecciono una tension de entrada usando el potenciometro
2. El OpAMp es un **buffer**
	* _esto te evita el problema de que sino en un divisor de tension la corriente que extraes del medio tiene que ser x10 la que circula en total_
	* Ademas te ahorra la caida de $V_{be}=0.7V$
3. La tension que seleccione, buffereada por el OpAMp, entra como señal a la fuente de corriente constante con **BJT**
4. La fuente de corriente constante con **BJT** hace su trabajo, tal como se vio antes en la seccion de fuentes de corriente constante con BJT 

![](https://i.imgur.com/nY49qML.png =600x)
**Recordamos que** 
La fuente esta sometida a las mismas limitaciones que la fuente de corriente BJT
* El transistor tiene que **estar funcionando en zona activa** ya que el sistema trabaja 
	* forzando una tension $V_e$ (en este caso con el OpAmp)  
	* Al estar forzada, se da que  $I_e=\frac{V_e}{R_e}$
	*  Y siempre que estemos en zona activa $I_e=I_b*\beta$
	* Y eso logra el objetivo de que $I_e$ sea independiente del valor de  $R_c$  (fuente de corriente constante)
* Como tiene que estar en zona activa, $V_{ce}>0.7V$
	* Entonces cuando calcules la fuente, hay que ver que estemos en zona lineal para la corriente  y $Rl$ que elegis 
		* $V_{in}=V_{Rc}+V_{ce}+V_{Rl}$


![](https://i.imgur.com/M7K9mFu.png =500x)
#### Calculo

Quiero una fuente de corriente constante de $100ma$ que  soporte una carga de desde $1\Omega$ a $100\Omega$.
[ejemplo](https://tinyurl.com/yf8wjo73)
![](https://i.imgur.com/1T5vW4p.png)

Por ley de ohm buscamos $V_{rc}$


Con $100\Omega$
$0.1= \frac{V_{Rc}}{100}$
$10V= V_{RcMax}$ es la **maxima** tension que tendre en $R_c$

Con $1 \Omega$
$0.1= \frac{V_{Rc}}{1}$
$0.1V= V_{RcMin}$ es la **minima** tension que tendre en $R_c$

Osea que 
$$0.1V<V_{Rc}<10V$$

**Entonces:**
Se que 
$V_{ce}>1V$ para estar en zona de saturacion
**por KVL**
$V_{in}=V_{RcMax}+V_{ceMin}+V_{Rl}$
 $V_{in}=10+1+V_{Rl}$
 **Por ley de ohm**
 $V_{in}=11+I_{Rl}*R_l$
 sabemos que $I_{Rl}\approx I_{Rc} = 100ma$
 $V_{in}=11+0.1amp*R_l$


Ahora tenemos que elegir algunos valores convenientes en la practica. Por ejemplo, puedo elegir mi tension de alimentacion.
* **Elijo un valor** de $V_{in}$ para mi alimentacion, por ejemplo $15V$
	*  $V_{in}=11+0.1amp*R_l$
	* $15=11+0.1amp*R_l$
	* $\boxed{R_l=40\Omega}$
* Ahora puedo despejar el **valor maximo de** de $V_{rl}$ que es $V_{pot}-0.7V$
	* $V_{rl}=0.1Amp*40\Omega$
	* $V_{rl}=4V$

**Conclusion:**
Para lograar nuestros specs, que eran
* $1\Omega<R_c<100\Omega$
* $I_c=100ma$

 necesitamos
* $V_{in} = 15V$
* $R_l=40\Omega$
* $0V<V_{pot}<4V$


### Aplicacion 4: BJT emitter follower mejorado

[fuente](https://www.youtube.com/watch?v=T2Zjyv2E1GQ&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=105)

No es mas que un **Emitter-Follower con BJT** comun, solo que se puede usar el OpAmp para reducir la corriente necesaria para modificar su valor.

_Antes necesitabas un divisor de tension por el que corriera una corriente $I$ diez veces mayor de la que usabas para mover el transistor, ahora esa limitacion no existe y entonces I puede ser 
minuscula, gastanto menos energia_

Antes:
![](https://i.imgur.com/f1vg4lc.png)
Ahora, con un OpAmp, podemos obtener el mismo resultado haciendo pasar poca corriente por el potenciometro.
[ejemplo](https://tinyurl.com/yzjcotkz)
![](https://i.imgur.com/v7uLyXL.png)
Hay que tener encuenta 
* la corriente maxima que puede  sacar el opamp, que condiciona la corriente maxima en la resistencia.
	* EJ:
	* $I_{max}=60ma$
	* $I_r=\beta*60+I_b$
* Si el transistor precisa disipador


## + El amplificador no inversor
[fuente](https://www.youtube.com/watch?v=LBu24VHjGRU)
[fuente 2](https://www.youtube.com/watch?v=jshDLjyHOj0&list=PLL_nf1OmixTTd7rEoqoM6aJ5ZdI-V47vs&index=4)
Se trata de un OpAmp con:
* La señal conectada a $V_{ni}$ 
* El feedback se conecta a **tierra**.


[ejemplo](https://tinyurl.com/yjx78vg3)

![](https://i.imgur.com/OOPqryQ.png)


**El funcionamiento es super sencillo**
* La señal entra por $V_{ni}$ (ej $5V$)
* El OpAmp compensa por feedback negativo para llevar a $V_{i}$ hacia $5V$
* Para hacerlo debe atravesar las resistencias, por consiguiente 
	* $V_i$ tendra $5V$ cuando el **divisor de tension los genere**
	* Entonces **OpAmp tiene que generar mas** de $5V$ para que en el divisor existan 5V


**Entonces:** $V_{ni}=\frac{R_{feedback}}{R_{base}+R_{feedback}}*V_{out}$

**Re-escribiendolo:**


$$\huge{\boxed{A=\frac{V_{ni}}{V_{out}} = \frac{R_{feedback}}{R_{base}}+1}}$$

O tambien


$$\huge{\boxed{V_{out}=(\frac{R_{feedback}}{R_{base}}+1)*V_{in}}}$$

 :warning:-  :warning:-  :warning:-  :warning:
Esto implica que **LA GANANCIA NO PUEDE SER MENOR A 1 EN ESTOS AMPLIFICADORES** 
_por el $+1$, que esta causado por que el divisor de tension nunca puede darte menos tension en su salida de la que le pones en la entrada_
 :warning:-  :warning:-  :warning:-  :warning:
 
### Ventajas y desventajas

* **Ventajas**
	* No invierte la señal
	* La **impedancia** es zero (no consume corriente de la fuente)
* **Desventajas:**
	* La **ganacia** no puede ser menor a $1$

### Calculo de impedancia - WIP
[fuente](https://www.youtube.com/watch?v=mhaa4QElSOw&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=100)

### Aplcacion: Fuente estabilizada de valor variable

Con el OpAmp podemos ademas hacer algo que **antes era imposible**, podemos tener una fuente que
1) **tenga tension estabilizada por zener**
2) Y ademas  **pueda proveer una tension variable, sin cambiar el zener por otro valor**

>:warning:**CRITICO:**
En todas las fuentes anteriores, si querias otro valor de tension estabilizado por zener, **tenias que cambiar el zener para que** $Vz=V_{out}$, pero usando un OpAmp podemos **Amplificar la tension $V_z$ de referencia para que la salida sea otra tension estabilizada $V_{out}$ mas grande!**


**FUNCIONAMIENTO:**

>**EN RESUMEN:** amplfico o minizo la tension de referencia del zener con un amplificador inversor hecho con un potenciometro.

Formamos un **amplificador no inversor** con la salida del zener ($V_z$) como un parametro y la salida de la fuente pasada por un divisor de tension ($V_{i}$) del otro.
Cuando el OpAmp trata de compensar $V_i$  y $V_{ni}$(que es $V_z$) tiene que atravesar el **divisor de tension**, entonces para hacerlo tiene que aumentar $V_{out}$ aumentando la tension de salida de nuestra fuente.

Esto excita mas el transistor (aumenta $V_b$ por que $V_b=V_{out}$)

[ejemplo](https://tinyurl.com/yfhu48y9)
![](https://i.imgur.com/dfZqPa9.png)


## + La masa virtual 
[fuente 1](https://www.youtube.com/watch?v=i0WQ_NsgpxI)
[fuente 2](https://www.youtube.com/watch?v=_fKwEeyVf2I)
[fuente 3 - muy buena](https://www.youtube.com/watch?v=km6delqG-Dc)


Como vimos en el buffer, El OpAmp cuando esta retroalimentado negativamente, ajusta su salida  $V_{out}$ (es decir, una de sus entradas $V_{ni}$ o $V_i$, por que estan conectadas) para lograr que


$$\huge{\boxed{V_i=V_{in}}}$$

Esto implica que si **una entrada esta a tierra** y la otra **esta retroalimentada y tiene una señal (ej $5V$)** entonces **el OpAmp va a modificar su salida para llevar esa señal a cero volts**
>**Aclaracion:** _Obviamente el OpAmp solo puede cambiarle la tension a la terminal a la que esta conectada la retroalimentacion, no puede llevar la terminal de $0V$ hacia $5V$_

A esta compensacion se le llama **Tierra virtual** por que  aunque es una tierra ($0V$) artiificialmente mantenida por la lucha entre $V_i=5V$ y la compensacion del OpAmo $V_{out}=-5V$ para llevar ambas entradas al mismo valor ($0V$)

[Ejejmplo](https://tinyurl.com/ydycf3nh)
![](https://i.imgur.com/uxnYEcv.png)


## + El amplificador inversor 

### Intro y concepto
[fuente 1](https://www.youtube.com/watch?v=yAxt7Zq2DJA&t=258s)
[Fuente 2 - grosa!](https://www.youtube.com/watch?v=km6delqG-Dc)
[fuente 3](https://www.youtube.com/watch?v=iz-01nv-v2w&list=PLL_nf1OmixTTd7rEoqoM6aJ5ZdI-V47vs&index=5)
Se trata de una minima modificacion al concepto de masa virtual.

> **CRITICO:** El circuito es **identico al amplificador no inversor** solo que **la tierra y la fuente de señal estan itercambiados de lugar**

En esta imagen vemos el concepto de **masa virtual**, donde el OpAmp por negative feedback busca que $V_i = V_{ni}$, entonces busca anular los $5V$ de entrada de $V_i$ y como consecuencia genera $-5V$ de salida, y esto anula la tensión de $V_i$ tal que $V_i=0V=V_{ni}$ 
[Ejejmplo](https://tinyurl.com/ydycf3nh)
![](https://i.imgur.com/uxnYEcv.png)
Si modificamos las resistencias tal que **no sean resistencias iguales** entonces **cambiamos el ratio necesario para anular las tensiones**


Osea que ahora 
* $R_1=2*R_2$
* ademas $V_i=3V$
* **entonces:** $V_{out}$ se tiene que ajustar en $-6V$ para anular los $3V$ de la entrada


[ejemplo](https://tinyurl.com/yc426vhc)
![](https://i.imgur.com/bBEVv1J.png)
### Deduccion y equacion
[fuente](https://www.youtube.com/watch?v=yAxt7Zq2DJA&t=258s)
El fundameno de esto es simple, como por la entrada del OpAmp no circula corriente, entonces hay una sola corriente $I$.
![](https://i.imgur.com/HBijThe.png)
**Entonces recordando:**
* la **ley de ohm**  
*  que hay una sola corriente $I$ 
* que en la masa virtual la tension es cero 
	* osea $V_i$ cae toda en $R_1$
	*  y $V_{out}$ cae toda en $R_2$

**Planteo la ley de ohm para los dos resistores:**
* $V_i=I*R1$
* $V_{out}=I*R2$

**Como es la misma $I$** para las dos equaciones, despejamos e igualamos las equaciones
$\frac{V_i}{V_{out}}=\frac{R_1}{R_2}$

**CONCLUSION:**
Recordamos que amplificacion $A =\frac{V_{in}}{V_{out}}$, entonces la amplificacion de este circuito esta dictada por 
$$\huge{\boxed{A=\frac{R_1}{R_2}}}$$



Entonces la **tension de salida del OpAmp en este circuito es proporcional al ratio de las resistencias**
[Ejemplo en AC](https://tinyurl.com/y8wwdj75)
![](https://i.imgur.com/Q39MtCG.png)
### Ventajas y desventajas

**Desventajas:**
* Invierte la señal de entrada
* **tiene impedancia no despreciable** por que fluye corriente desde la fuente.

**Ventajas:**
* Permite ganancias menores a $1$ (osea atenuaciones)
	* Por consiguiente puede ser usado como mixer de audio por ejemplo, donde amplificas algunas cosas y atenuas otras

### Calculo de impedancia 

[FUENTE](https://www.youtube.com/watch?v=lNbfvl_Pgyo&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=99)

**IMPEDANCIA DE ENTRADA:**
Podemos ver la impedancia de entrada es simplemente $R_1$ ya que 
* por el concepto de masa virtual, todo el potencial de entrada cae en $R_1$, por que la entrada del OpAmp esta necesariamente a $0V$ 
	* $V_{in}=V_{r_1}$
* por ley de ohm, si conozco $V_{r1}$ y $R_1$, la corriente $I$ que atraviesa al resistor  queda definida, y a la relacion de tension-corriente es a lo que le decimos impedancia!

$$\frac{V_{r_1}}{I}=R_1=Z_{in}$$

![](https://i.imgur.com/MGr9izC.png)


**IMPEDANCIA DE SALIDA:**

[fuente](https://www.youtube.com/watch?v=lNbfvl_Pgyo&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=100)
Se obtiene utilizando el circuito equivalente del amplificador operacional y obteniendo la resistencia vista desde el lado de la carga.

![](https://i.imgur.com/QOfg2Du.png)
![](https://i.imgur.com/DqSDgb1.png)
Analizando ese circuito, se obtiene que 

$$\huge{\boxed{Z_{out}=\frac{r_0}{1+\beta*A}}}$$

Donde
* $r_0$ es la impedancia interna del OpAmp
* $\beta$ es el ratio $\frac{R_1}{R_2+R_1}$
* $A$ es la amplificacion del circuito



## + Convertidor I-V/ Transimpedance amp

[Fuente 1](https://www.youtube.com/watch?v=OMnZehJNGCY7)
[Fuente 2](https://www.youtube.com/watch?v=kSF_YRUGvAo&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=123&t=4s)
[Fuente 3](https://www.allaboutcircuits.com/video-tutorials/op-amp-applications-current-to-voltage-converter/)

Este circuito **usa el feedback negativo** para  **convertir una señal de corriente en una señal de tension**

**Relevancia:**
* Muchos sensores funcionan enviando **señales de corriente en vez de tension**, por que permite transmitir a largas distancias sin ruido.
* Podemos interpretar dispositivos que funcionan como fuentes de corriente, como los **fotodiodos**

**LA FORMA MAS SIMPLE:**
Este circuito en su forma mas simple puede hacerse con una resistencia
![](https://i.imgur.com/NqccknJ.png =200x)
**Problemas:**
[fuente](https://www.allaboutcircuits.com/video-tutorials/op-amp-applications-current-to-voltage-converter/)
 1) Alta **impedancia de salida** $Z_{out}$
	 * Cuanto conectes esa salida de tension a cualquier cosa, tu tension  caera.  
 2)  Alta **impedancia de entrada** ($Z_{in}$igual a $R$)
	 *  Si queres crear tensiones altas, tenes que poner resistencias altas, eso aumenta la impedancia de entrada y la fuente de corriente puede no bancarselo (por su resistencia interna)
	 * [ejemplo](https://tinyurl.com/yejy3dus)





**SOLUCION:**

Para solucionarlo usamos un OpAMp con feedback negativo.

[ejemplo](https://tinyurl.com/yf4x7ekg)
![](https://i.imgur.com/4ZcAzFl.png)
**Funcionamiento:**
1) La corriente $I$ circulara a traves del resistor, generando una caida de tension $V_R$
2) Por **masa virtual**, la conexion donde esta enchufada la fuente de corriente esta a $0V$
3) Para generar esa masa virtual, el OpAmp tiene una salida de $-V_R$

![](https://i.imgur.com/nt3tayt.png)
**De esta forma vemos que solucionamos los dos inconvenientes.**
1) **Baja impedancia de salida** $Z_{out}$
	*	La tension de salida esta determinada por el feedback negativo, entonces colocar cargas a a salida del OpAMp no modifica la tension de salida (Siempre que estes dentro de la corriente maxima soportada por el OpAmp )
2) **Baja impedancia de entrada** $Z_{in}$
	* La fuente de corriente esta conectada a una tension virtual de $0V$, es como si la **fuente de corriente estuviera cortocircuitada a tieraa**
	* El OpAmp es el que genera la tension negativa para atraer a la corriente
	* Entonces **para la fuente de corriente, es como un corto, ** $Z_{in}\approx 0$ 

**Ejemplo completo**
[fuente](https://tinyurl.com/yezdvnav)

![](https://i.imgur.com/n5s6tbd.png)





# Operaciones matemáticas - WIP

## Sumadores
### Sumador analogico inversor
[fuente](https://www.youtube.com/watch?v=riudPrSbeJs&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=102)

#### Introduccion y Circuito previo

**NOTEMOS EL SIGUIENTE CIRCUITO**
[EJEMPLO](https://tinyurl.com/ydjf4lko)
![](https://i.imgur.com/KXKUMdB.png)
Notemos que para que en el centro existan $0V$ es necesario que la suma de las entradas sea igual al inverso de la salida.
EJ: $$V_{compensador}=-15V=-1*(5V+5V+5V)$$

**Ademas** vemos que se forma un divisor de tension para cada entrada entre los dos resistores, asi que si duplico una resistencia, se divide su tension a la mitad, entonces seria.

$$V_{compensador}=-12.5V=-1*(5V+2.5V+5V)$$
![](https://i.imgur.com/RQZEfzV.png)
**Si combinamos esto con un opamp**, **podemos obtener ese** $V_{compensador}$ **automaticamente!** y sera la suma de las entradas (que pueden ser ajustadas para amplificar o reducir segun cada resistencia).

* El punto de $0V$ seria $V_i$, y el amplificador inversor se encargara de ajustar $V_{out}$ para que $V_i=0$, que es lo que haciamos manualmente en el ejemplo anterior


[ejemplo](https://tinyurl.com/yblgdkq9)
![](https://i.imgur.com/1fPVnUH.png)

#### Detalle y Calculo

Vemos entonces que 
* Cada entrada esta en paralelo
* Cada una tiene su propia resistencia $R$
* Como $A=\frac{R_1}{R_2}$ entonces
	*  el **ratio de amplificacion de cada entrada es independiente**, por que cada una tiene su propia $R_1$, mientras que la $R_2$ es la resistencia del feedback

_eso lo podes deducir ignorando cada fuente con su resistencia y despues sumando los resultados, mediente teorema de superposicion_

Matematicamente definimos esto como

$$\large{\boxed{V_{out}=(\frac{V_1}{R_1}+\frac{V_2}{R_2}+ \frac{V_3}{R_3}...)R_{feedback}}}$$


[ejemplo](https://tinyurl.com/yblgdkq9)
![](https://i.imgur.com/1fPVnUH.png)



A continuación podemos ver un circuito donde las resistencias $R_1$ de cada entrada son diferentes. podemos ver como el ratio $A=\frac{R_1}{R_2}$ **afecta a los dos voltajes de entrada por separado**
[ejemplo](https://tinyurl.com/y873wst9)
![](https://i.imgur.com/oYfyRCP.png)


#### Aplicacion 1: AC signal offseter

Podemos "sumar" una señal AC y una señal DC para darle a la señal AC un offset

[ejemplo](https://tinyurl.com/ya6mzvef)
![](https://i.imgur.com/wdDtj7d.png)
#### Aplicacion 2: Promediador 


Si coloco una cantidad de sensores (o fuentes de cualquier tipo) entonces puedo promediarlos! solo tengo que procurar que
* tengan todos la misma resistencia 
*  que $\frac{R_{feedback}}{R_{sensor}}=\frac{1}{\text{cantidad de sensores}}$

[ejemplo](https://tinyurl.com/yc9euxe5)
![](https://i.imgur.com/DWbyCfD.png)

ya que
$$\large{\boxed{V_{out}=(\frac{V_1}{R_1}+\frac{V_2}{R_2}+ \frac{V_3}{R_3}...)R_{feedback}}}$$

entonces si las resistencias son iguales
$$\large{\boxed{V_{out}=(\frac{V_1}{R_1}+\frac{V_2}{R_1}+ \frac{V_3}{R_1}...)R_{feedback}}}$$

$$\large{\boxed{V_{out}=(V_1+V_2+V_3)\frac{R_{feedback}}{R_1}}}$$

y si  $\frac{R_{feedback}}{R_{sensor}}=\frac{1}{\text{cantidad de sensores}}$

$$\large{\boxed{V_{out}=(V_1+V_2+V_3)\frac{1}{3}}}$$


Y eso es el promedio!

#### Aplicacion 3: Mezclador de audio 

[fuente](https://www.youtube.com/watch?v=UEDkt36-Q8I&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=103)

Podemos usar el **sumador** para **sumar varias señales, por ejemmplo de audio**. 

Si ademas le añadimos un potenciometro a cada canal, podemos controlar la resistencia $R_1$ de cada uno, y entonces podemos subir o bajar la amplificacion de cada canal por separado, ya que recordamos que


$$\large{\boxed{A=\frac{R_1}{R_{feedback}}}}$$

Entonces teniendo el siguiente circuito

[ejemplo](https://tinyurl.com/ybf4sjy6)
![](https://i.imgur.com/NRbq7ff.png)
Se trata de un sistema identico  al sumador, pero que
* Le colocamos **buffers** en las entradas para reducir su impedancia (ya que por ejemplo una guitarra electrica no tiene mucha salida de corriente)
* $R_1$ esta compuesta de una resistencia fija y una resistencia variable. 

Como el sumador simplemente suma cada señal, entonces el resultado final es la suma de cada señal amplificada. Cada señal se amplifica segun la equacion de amplificacion

$$\large{\boxed{A=\frac{R_1}{R_{feedback}}}}$$

es decir

$$\large{\boxed{A=\frac{R_{potencimetro}+ R_{fija}}{R_{feedback}}}}$$


En la practica esto significa que **controlamos la amplitud de cada señal, y por ende su volumen!**

### Sumador analogico no inversor

#### Intuicion y circuito previo
[fuente](https://www.youtube.com/watch?v=ocIYmhMPYJ0&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=107)
Notamos el siguiente circuito, notamos que la tension final es
* **Maximo** $5V$
* **Proporcional** a las tensiones de entrada y a las resistencias

[EJEMPLO](https://tinyurl.com/yfzzyo53)
![](https://i.imgur.com/oPzD5wg.png)

La formula que domina la salida, por teorema de superposicion, es

$$V_{out}=\frac{\frac{V_1}{R_1}+\frac{V_2}{R_2}+\frac{V_3}{R_3}}{\frac{1}{R_1}+\frac{1}{R_2}+\frac{1}{R_3}}$$

Cuando las resistencias son todas iguales
$$\frac{V_1+V_2+V_3}{\text{numero de fuentes}}$$


Vemos que este circuito entonces basicamente **Calcula el promedio de las tensiones si las resistencias son todas iguales.**

#### Detalle y calculo


[fuente](https://www.youtube.com/watch?v=ocIYmhMPYJ0&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=107)

Si conecto esto a un **sumador no inversor** a la salida de ese circuito y recordamos su ecuacion

[ejemplo](https://tinyurl.com/yhw5y87e)
![](https://i.imgur.com/HF7lS4a.png)

**Equacion del amplificador no inversor:**
$$V_{out}=(\frac{R_{feedback}}{R_{base}}+1)*V_{in}$$
**Equacion del circuito promediador**
$$\frac{V_1+V_2+V_3}{\text{numero de fuentes}}$$

Vemos que **el circuito promediador seria la entrada del OpAmp**, reemplazando entonces tenemos que
$$V_{out}=(\frac{R_{feedback}}{R_{base}}+1)*\frac{V_1+V_2+V_3}{\text{numero de fuentes}}$$
Entonces, si calculamos nuestros valores tales que
 $$\frac{R_{feedback}}{R_{base}}+1=\text{ numero de fuentes}$$, podemos deshacernos de la operacion de _promedio_ y tener una suma!
 
$$V_{out}=(\cancel{\frac{R_{feedback}}{R_{base}}+1)}*\frac{V_1+V_2+V_3}{\cancel{\text{numero de fuentes}}}$$


**CONCLUSION:**
**Queda un sumador**
$$\boxed{V_{out}=V_1+V_2+V_3}$$

**siempre que**

 $$\large{\boxed{\frac{R_{feedback}}{R_{base}}+1=\text{ numero de fuentes}}}$$,

## Restadores/Diferenciadores

### Restador

[fuente 1](https://www.youtube.com/watch?v=9lQSTuuAkXU&list=PLL_nf1OmixTTd7rEoqoM6aJ5ZdI-V47vs&index=6)
Se trata de u n circuito que hace la resta de dos señales, su funcionamiento es el siguiente.

1. Se divide la señal $V_1$ en dos con un divisor de tension
2. El OpAmp toma esa señal $V_1$ en su **entrada no inversora** y modifica su salida para  obtener $V_1$ tambien en la **entrada inversora**
3. Vemos que la caida de tension en el **primer resistor** conectado a $V_2$ tiene que ser entonces $V_1-\frac{1}{2}V_2$
4. Vemos que, como el segundo resistor es igual, su caida debe ser igual, entonces debe ser $V_1-\frac{1}{2}V_2$
5. Entonces la caida total en los dos resistores es $V_1-2(\frac{1}{2}V_2)$ es decir $V_1-V_2$
6. Entonces el OpAmp tiene que tener una salida de $V_1-V_2$  para que en su entrada inversora apareza el valor de $\frac{1}{2}V_2$

**Entonces:**

$$\boxed{V_{out}=V_1-V_2}$$

[ejemplo](https://tinyurl.com/yjvhbary)
![](https://i.imgur.com/IAdDvoe.png)

### Restador Amplificador (Diferential amplifier)

#### Funcion y funcionamiento
[fuente 1](https://www.youtube.com/watch?v=9lQSTuuAkXU&list=PLL_nf1OmixTTd7rEoqoM6aJ5ZdI-V47vs&index=6)

Se trata de una **modificacion del circuito anterior** que
* **Resta**
* **Amplifica:** Multiplica la resta por una constante

Lo unico que se cambia  son los valores de los resistores, **se cambian en parejas tales que generemos dos divisores de tension identicos** con $R_1$ y $R_2$

![](https://i.imgur.com/M0VNdBr.png)
Obtendremos asi una salida de 

$$\large{\boxed{V_{out}=\frac{R_2}{R_1}(V_1-V_2)}}$$

#### Deduccion

![](https://i.imgur.com/opWHZdr.png)
Sabemos que el OpAmp intenta compensar $V_{out}$ para llegar a que $V_i=\text{caida 0 }$, y para hacerlo, debe atravesar la $caida2$, entonces

$$(1)\boxed{V_{out}=[Caida0]-[Caida2]}$$
**Viendo que:**
* $(2)\boxed{Caida0 = \frac{R_2}{R_1+R_2}V_1}$ por el **divisor de tension** y el hecho de que el OpAmp copia la tension de una terminal a la otra
* $(3)\boxed{Caida2 = \frac{R_2}{R_1}(V2-Caida0)}$ por que como $R_1$ y $R_2$ estan en serie, sabemos que
	* $Caida2$ es la caida de tension en la resistencia $R_2$ y esta **es igual a la caida $R_1$** que es $(V2-Caida0)$ 
	* Pero ademas **es proporcional a su valor de resistencia** (por eso el $\frac{R_2}{R_1}$)

**Entonces reemplazando $(1)$ con $(2)$ y $(3)$ me queda**
$$V_{out}=[\frac{R_2}{R_1+R_2}V_1]-[\frac{R_2}{R_1}V2-Caida0]$$




**Reemplazando $Caida0$ con $(2)$ nuevamente seria**


$$V_{out}=[\frac{R_2}{R_1+R_2}V_1]-[\frac{R_2}{R_1}V2-\frac{R_2}{R_1+R_2}V_1]$$

**Algunas simplificaciones**

$$\large{\boxed{V_{out}=\frac{R_2}{R_1}(V_1-V_2)}}$$


### Amplificador de instrumentacion

#### Intro
[fuente](https://www.youtube.com/watch?v=NvyDw8ZpLd0)
Un Amplificador de instrumentacion se trata de un amplificador, normalmente presentado en forma de un circuito integrado y que tiene las siguientes propiedades:
* **AMPLIFICA LA DIFERENCIA** entre dos señales
	* $V_{out}=A*(V_2-V_1)$
	* La ganancia es generalmente regulable por una constante 
* **SALIDA** offseteable por un valor de referencia $V_{ref}$
	* $V_{out}+V_{ref}$
* **ANULA** señales iguales (por que si se restan dos señales igules dan cero.)
* **IMPEDANCIA DE ENTRADA ALTSIMA** para no cargar al elemento que queremos sensar

Juntando todo, la salida seria
$$\large{\boxed{V_{out}=A(V_1-V_2)+V_{ref}}}$$



![](https://i.imgur.com/vsPSDbB.png)

#### Usos y ventaja

[fuente 1](https://www.youtube.com/watch?v=NvyDw8ZpLd0)
[fuente 2](https://www.youtube.com/watch?v=ktKTxEsQzlg)


Algunos de los usos que se le pueden dar son
* **LIMPIAR Y AMPLIFICAR SEÑALES DEBILES EN ENTORNOS RUIDOSOS, _incluso si el ruido es mas grande que la señal_:**
	* Como eliminas las señales iguales al restarlas, si se te acopla ruido electromagnetico en ambos cables, El IA lo elimina. Entonces cuando el IA recibe una señal ruidosa y debil:
		* **Limpia el ruido**
		* **Amplifica la señal debil**
	* **Aplicaciones:** 
		* Tomar señales de ECG/EKG, monitores cardiacos, amplificar señal de sensores y termocuplas, sensores en puente wheatstone, Sensores de presion sanguinea, 
		* Todo momento donde **la señal a medir es tan debil que es mas chica que el ruido ambiental**
* **OBTENER SEÑAL DE UN SENSOR WHEATSTONE**
	* Los sensores en puente wheatstone tienen una salida **diferencial**, es decir 

![](https://i.imgur.com/eezV0my.png) 

#### Construccion con elementos discretos
##### Pre amplificacion de diferencia
[fuente 1](https://www.youtube.com/watch?v=OeelJmS_G10)
[fuente 2](https://www.youtube.com/watch?v=SwuoWi1K7s4&list=PLqHzkYuCsENKahyIQ3IgyeP6SulVngqyb&index=3)
[fuente 3](https://www.youtube.com/watch?v=v74e2LFSCGA&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=108)

**Lo primero que hacemos es:**
* **Subir la impedancia a algo gigante**
* **Amplificar la diferencia de las señales**

Para esto usamos una etapa de pre-amplificacion como la que se muestra acontinuacion, vemos que al estar conectadas las entradas a OpAmps, **la impedancia sera gigante**

[Ejemplo de etapa de preamplificacion diferencial](https://tinyurl.com/yzp69nnc)
![](https://i.imgur.com/qcNUvUe.png)

Vemos ademas que debemos amplificar la diferencia entre las dos señales, esto lo logramos con la relacion entre las resistencias $R_1$ y $R_g$. La relacion sera

$$\huge{\boxed{V_{out}=(V_1-V_2)(1+\frac{2R_1}{R_g})}}$$

**DEDUCCION:**
[fuente](https://www.youtube.com/watch?v=v74e2LFSCGA&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=109)
![](https://i.imgur.com/P9jw5Q6.png)

Vemos por las caidas de tension que
* $V_a-V_{R_1}=V_1 \Rightarrow  (1)\boxed{V_a=V_1+V_{R_1}}$
* $(2)\boxed{V_b=V_2-V_{r_1}}$

Ademas, notamos que la corriente que atraviesa las tres resistencias es la misma, entonces

* $I=\frac{V_{R1}}{R_1}$ y $I=\frac{V_g}{R_g}=\frac{V_1-V_2}{R_g}$
	* Entonces
	* $(3) V_{R_1}=I*R_1$
	* $(4)I=\frac{V_1-V_2}{R_g}$

**Teniendo en cuenta todo lo anterior, veamos cual es el valor de la diferencia de tension de salida**

$$V_s=[V_a]-[V_b]$$

**Reemplazando por $(1)$ y $(2)$**

$V_s=[V_1+V_{R_1}] - [(V_2-V_{R_1})]$

**simplificando**
$V_s=V_1-V_2+ 2V_{R_1}$

**Reemplazando por $(3)$**
$V_s=V_1-V_2+ 2*I*R_1$

**Reemplazando por $(4)$**

$V_s=V_1-V_2+ 2*\frac{V_1-V_2}{R_g}*R_1$

**Simplificando:**
$$\large{\boxed{V_{out}=(V_1-V_2)(1+\frac{2R_1}{R_g})}}$$


##### Construccion completa


Se trata simplemente de la etapa de preamplificacion conectada a un **diferenciador amplificador**.

Notemos que **la etapa de preamplificacion tiene su** $R_g$ **fuera del integrado para permitir ajustar la ganancia al valor deseado!** 
![](https://i.imgur.com/3KETV3T.png)
## Integradores


### Introduccion
[fuente](https://www.youtube.com/watch?v=8WGA53vPO_Y&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=110)

El siguiente circuito tiene como salida la integral de la señal de entrada.
Esto sucede en virtud del capacitor, que **integra la corriente**.

Este circuito
* **Integra** la tensión de entrada a lo largo del tiempo
* **invierte** el valor de la integral
* **multiplica** el resultado por una constante $\frac{1}{RC}$

La salida de este circuito es

$$\boxed{\huge{\frac{-1}{RC}\int{ V_{in}(t)dt}=V_{out}(t)}}$$

[ejemplo](https://tinyurl.com/yzpjbjwo)
![](https://i.imgur.com/NV8Tlim.png)

Entrada (verder) vs salida (rojo)
![](https://i.imgur.com/SqHD1MZ.png)
### Derivación
#### Conocimientos previos

**RECORDANDO AL CAPACITOR COMO INTEGRADOR DE CORRIENTE:**
Recordamos que **la capacitancia** es la capacidad $F$ de almacenar una cantidad de carga $Q$ por cada volt $V$ desarrollado.
$$\frac{Q}{V}=F$$ 
Despejando por tension
$$Q=FV$$
Notamos que si hay un cambio de tension a lo largo del tiempo, entonces la carga tambien cambia a lo largo del tiempo

$$\frac{dQ(t)}{dt} =F\frac{dV(t)}{dt}$$

Sabiendo que la definicion de corriente $i(t) = \frac{dQ(t)}{dt}$

$$F\frac{dV}{dt}=i(t)$$

#### Derivación de la formula
[fuente](https://www.youtube.com/watch?v=8WGA53vPO_Y&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=111)
![](https://i.imgur.com/vp0V0fl.png)
Vemos que la corriente $i$ es identica en el resistor $R$ y en el capacitor $C$

**El OpAmp mantiene siempre la tierra virtual, eso significa que:** 
* $V_r=V_{in}$ , independientemente de la tension del capacitor. $V_c$
* Eso implica que por $R$ pasa una corriente que obedece a la ley de ohm $\frac{V}{R}=I$
	*  _sin el opamp esto no seria asi ya que **la tension del capacitor a medida que se carga modificaria la caida en el resistor**_
	* Esto hace que el capacitor se cargue a **corriente constante**, por que esta en serie con la resistencia, osea que tiene le mismo valor de $i$

**Entonces vemos que:**
* Conocemos como calcular la tension del capacitor $V_c$
	*  $F\frac{dV}{dt}=i(t)$
* Conocemos como calcular la tension de la resistencia
	* $\frac{V_R(t)}{R}=i(t)$

La corriente que pasa por ambos es la misma, ya que el OpAmp no consume corriente.Entonces podemos igualarlos usando $i$
$$F\frac{dV}{dt}=\frac{V_R(t)}{R}$$
despejando

$$\frac{dV_c(t)}{dt} =\frac{V_R(t)}{RF}$$
Integrando ambos extremos

$$\boxed{\large{V_c(t)+V_{c-inicial} =\frac{1}{RF}\int{V_R(t)}}}$$


**Notamos que:**
* $V_c$ es lo mismo que $-V_{out}$, por que 
	* $V_{out}$ es la tension de una punta del capacitor con respecto a tierra
	* $V_{c}$ tambien es con respecto a tierra, por que una de las patas del capacitor esta en **masa virtual** 
* $V_r$ es igual a $V_i$, por que
	* $V_i$ esta medido a tierra
	* $V_r$ tambien esta con referencia a tierra, por que una de sus patas esta en **masa virtual**

#### Por que  hace falta el OpAmp?
[fuente](https://electronics.stackexchange.com/questions/68560/integrator-and-differentiator-op-amps-vs-rc-networks)
Notamos que solamente usamos equaciones de capacitor para resolver el problema. Por que necesitamos al OpAmp entonces? no podriamos usar simplemente un capacitor que te integra la corriente y listo?
![](https://i.imgur.com/kkVGxMX.jpg)


**Notamos que el circuito sin opamp tiene algunos problemas:**

* No podemos consumir corriente en la salida $V_c$ por que eso nos modificaria el valor de la tension
* A medida que $V_c$ aumenta, $I_c$ disminuye y como resutado $V_r$ disminuye, generando la curva caracteristica de carga del capacitor
	* ![](https://i.imgur.com/AxWqpB5.png)
	* 
Vemos este ultimo efecto mas claramente en el siguiente circuito
[ejemplo](https://tinyurl.com/yzbzw2bg)
![](https://i.imgur.com/gD7Wbtt.png)

**El OpAmp resuelve estos  problemas, por que** 
* **Mantiene** la tension sobre el resistor constante aun cuando cambie la tension del capacitor, ya que el opamp mantiene la **tierra virtual**
	* Al haber tension constante en el resistor, por ley de ohm pasa una corriente constante sobre el resistor, al estar en serie con el capacitor este **mantiene el capacitor cargandose a corriente constante**
* **tiene baja impedancia de salida** por lo que podes usar la señal integrada para cosas utiles sin modificar el valor del capacitor

![](https://i.imgur.com/gXmXHPP.png)

### Saturacion y frecuencia
[fuente](https://www.youtube.com/watch?v=8WGA53vPO_Y&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=110)
La tension el OpAmp estara limitada por
* Cuanto se carga el condensador, **cuando este totalmente cargado dejara de subir**
* La **salida maxima del OpAmp**

Si la frecuencia de la señal de entrada es muy baja, el circuito integra una constante mucho tiempo (aumentando infinitamente) al llegar a la tension maxima de salida del OpAmp o cargar el capacitor ya no puede subir mas. 

![](https://i.imgur.com/vTGmg2z.png)

[Ejemplo](https://tinyurl.com/yjypeb3b)
![](https://i.imgur.com/Gqb8XZo.png)
### Integrador con eliminacion de DC

[fuente](https://www.youtube.com/watch?v=8WGA53vPO_Y&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=111)
Si tu integrador tiene a la entrada un componente DC, al integrarlo eventualmente va a llegar a la saturacion

![](https://i.imgur.com/K7lMku0.png)
Para evitarlo, necesitamos que el **capacitor pueda perder su carga**, lo podemos lograr con una resistencia en paralelo, ademas la hacemos igual a la otra resistencia para lograr una **amplificacion de 1**
[ejemplo](https://tinyurl.com/yz2rcwn2)
![](https://i.imgur.com/geWGqOk.png)
Es importante notar que **ahora que tenemos un circuito** $RC$ la **constante de tiempo** nos puede afectar, si **nuestra frecuencia es mas baja que la constante de tiempo** empezas a ver el efecto del **capacitor cargandose**

![](https://i.imgur.com/lAH5sqt.png)

**AUMENTANDO LA FRECUENCIA** o **aumentando la constante de tiempo** $\large{\tau}$ (usando $R$ o $C$ mas grandes) logras **no llegar al tiempo de carga** y asi evitas parcialmente ese efecto (notese que igualmente la curvatura existe)
![](https://i.imgur.com/V2r23XS.png)
# Osciladores

## Multivibrador Astable 


### Introduccion y funcionamiento
[fuente](https://www.youtube.com/watch?v=h2pdPoLVuUQ&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=117)
[mi pregunta en stackexchange](https://electronics.stackexchange.com/questions/559457/astable-multivibrator-using-opamps-why-does-it-start?noredirect=1#comment1459086_559457)

Es un circuito que transforma su alimentacion $V_{cc}$ en una señal pulsante cuadrada.


[ejemplo](https://tinyurl.com/yfz3dlt9)
![](https://i.imgur.com/8sLgNHi.png)

**Funciona asi:**
1. El OpAmp  arranca saturando a $+-V_{cc}$
2. La tension $V_{cc}$ se divide en el divisor de tension de abajo, por ejemplo si las resistencias son iguales, la tension en $V_{ni}$ es $\frac{1}{2}V_{cc}$
3. El capacitor de arriba se esta cargando por la tension $V_{cc}$
4. Cuando la tesion del capacitor supera a la tension en $V_{ni}$, el OpAmp invierte su salida y satura para el otro lado
5. El ciclo se repite, el capacitor se descarga y se carga con polaridad inversa hasta llegar a $\frac{-1}{2}V_{cc}$ y se invierte otra vez la salida del OpAmp, y asi..


**Inicio de la ocilacion:**
Es importante notar que en una situacion ideal, con el capacitor descargado, el circuto no arrancaria a oscilar.
Sin embargo, en la vida real, el OpAmp no es perfecto y existira una leve diferencia entre $V_{i}$ y $V_{ni}$ que se ira amplificando lentamente hasta saturar totalmente e iniciar la oscilacion

[Ejemplo](https://tinyurl.com/yfuvp6an)
![](https://i.imgur.com/Fh6CFYl.png)


### Calculo

[Fuente](https://www.youtube.com/watch?v=h2pdPoLVuUQ&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=117)
Los valores importantes que nos competen son

* **Amplitud** de la onda cuadrada
	* Es la alimentacion $+-V_{cc}$ del OpAmp
* **Periodo** de la onda cuadrada, que depende de: 
	* Cuanto tiempo tarde en cargar el capacitor
		* Depende de la **capacitancia** del capacitor y de la resistencia $R3$
	* A que tension debe cargar el capacitor 
		* Depende del divisor de tension $R1$ y $R2$
![](https://i.imgur.com/mMfadOu.png)


![](https://i.imgur.com/RI2YYiG.png)
**Por ejemplo:**
Si
* $R1 = 1K$
*  $R2=1K$ 
*  $V_{cc}=+-10V$
entonces el capacitor debe cargarse hasta $5V$ o $-5V$ dependiendo de en que parte del ciclo esta
![](https://i.imgur.com/cBBhnEA.png =350x)

Queremos calcular **el periodo** de la onda cuadrada, sabemos que el OpAmp 
* Cambio su saturacion cuando $V_{cap}=5V$
* La cambiara nuevamente cuando $V_{cap}=-5V$

Es decir, El tiempo que dura un segmento de la onda cuadrada es el mismo que **el tiempo que tarda el capacitor en pasar de** $V_{cap}=5V$ a $V_{cap}=-5V$ y luego nuevamente a $V_{cap}=5V$
![](https://i.imgur.com/9hOOs8S.png)


**Recordamos las formulas del circuito** $RC$**:**
* $\large{V_{cap}(t)=V_f+(V_i-V_f)e^{\frac{-t}{\tau}}}$ 
* Donde $\tau=R.C$ 

**ARRANCAMOS A CALCULAR:**

$$\large{V_{cap}(t)=V_f+(V_i-V_f)e^{\frac{-t}{\tau}}}$$

**Vemos que:**
* $V_f=10V$ por que $V_f$ la tension de carga, y la tension con la que cargamos el capacitor es $V_{cc}=10V$
	* _Ademas $V_f$ seria la tension final si dejaramos que el capacitor se cargara, pero el OpAmp va a interrumpir el proceso de carga antes que eso pase_
*  $V_i=-5V$ ya que $V_i$ es la tension inicial, que son los $-5V$ con los que arranca el capacitor al inicio del ciclo
* $V_{cap}(t)$ es la tension a la que quiero llegar al final de mi proceso, en este caso quiero cargar el capacitor hasta los $5V$

**Reemplazando:**
$$5V=10V+(10V-(-5V))e^{\frac{-t}{\tau}}$$ 

$$5V=10V+(15V)e^{\frac{-t}{\tau}}$$ 

$$-5V=15Ve^{\frac{-t}{\tau}}$$ 

$$\frac{-5V}{15V}=e^{\frac{-t}{\tau}}$$


**Recordando que:** $\tau=R.C$


$$\frac{-5V}{15V}=e^{\frac{-t}{RC}}$$

**Despejamos el tiempo** $t$

 $$t=RC \ln(\frac{15V}{-5V})$$

**NOTAMOS:** que obtuvimos el tiempo de carga del capacitor desde $5V$ hasta $-5V$, pero esto representa el largo de un segmento cuadrador de la onda.
Vemos que **el periodo sera el doble!**
 $$\boxed{P=2RC \ln(\frac{15V}{-5V})}$$
![](https://i.imgur.com/OjAeLMj.png)

### Con frecuencia variable/ajustable

Como calculamos recien, si el **periodo es linealmente dependiente de** $RC$, entonces cambiando esos valores cambiamos el periodo.


 $$\boxed{P=2RC \ln(\frac{15V}{-5V})}$$
 
La forma mas facil de hacerlo es con **un potenciometro**, de esta forma **modificamos** $R$ y asi cambiamos $$P
[ejemplo](https://tinyurl.com/yh3hw69o)
![](https://i.imgur.com/J1zghsH.png)
### Con onda cuadrada asimetrica

Puedo crear un circuito que genere ondas positivas de un largo diferente que las negativas, eso se logra simplemente **cambiando la velocidad de carga del capacitor con respecto a la de descarga**

Necesitas diodos con imperfecciones que dejen pasar un poquito de corriente para que el oscilador arranque.

[Ejemplo](https://tinyurl.com/ygsmjyf7)
![](https://i.imgur.com/otJC9Un.png)
![](https://i.imgur.com/yggrSQz.png)
### Aplicacon: PWM

[fuente](https://www.youtube.com/watch?v=pw1QjT7P9x4&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=120)


Simplemente controlando la onda asimetrica obtenemos un control PWM!.

[ejemplo](https://tinyurl.com/ye5qp6u2)
![](https://i.imgur.com/dTshKQo.png)
Tambien se puede modificar el ciircuito para funcionar sin una alimentacion simetrica de $5V-;5V$
[fuente](https://www.youtube.com/watch?v=W_oSg9_AKEk&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=111)

[ejemplo](https://tinyurl.com/yeflcxjr)
![](https://i.imgur.com/ClvW10q.png)

# Circuitos combinados - WIP

## Generador onda cuadrada y triang

### Funcionamiento

[fuente](https://www.youtube.com/watch?v=gR9TYcK5nzY&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=116)

Se trata de un circuito que **genera una onda cuadrada y otra triangular** a partir de una tension de alimentacion
[ejemplo](https://tinyurl.com/ygw9bs57)
![](https://i.imgur.com/01XQtEx.png =500x)
**se compone de dos partes:**
* Comparador con histeresis
* Integrador inversor

![](https://i.imgur.com/qgRkUaz.png =500x)
**Funcionamiento**
1. El Comparador con histeresis satura hacia algun lado
2. El integrador integra esa saturacin a lo largo del tiempo
3. El integrador llega a una cierta tension de salida que genera la tension de cambio  del comparador con histeresis en el divisor de tension
4. El comparador satura hacia el otro lado

![](https://i.imgur.com/SFHfw0w.png)
### Calculo
[fuente](https://www.youtube.com/watch?v=6gl4w7vstoM&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=119)
Las magnitudes que nos interesan son:
* **Amplitud** de la señal cuadrada
* **Amplitud** de la señal triangular
* **Frecuencia** $f$ de las dos señales (ambas estan a la misma frecuencia)

**AMPLITUD DE LA SEÑAL CUADRADA:**

Sera simplemente la tension se da saturacion del  Comparador con histeresis, por que esa es su salida.

A esto llamamos $V_1$

**AMPLITUD DE LA SEÑAL TRIAGULAR:**

La señal triangular termina cuando cambia la señal cuadrada
![](https://i.imgur.com/k6ebrQL.png)
La señal cuadrada cambia cuando el comparador con histeresis cambia de saturacion.
El comparador con histeresis cambia cuando la salida del divisor de tension da cero

![](https://i.imgur.com/9J5OQmU.png)

Recordamos que un divisor de tension con dos tensiones se calcula como

$$\boxed{V_{out}=V_2+(V_1-V_2)\frac{R_2}{R_1+R_2}}$$
y el OpAmp cambia cuando el divisor de tension tiene una salida de $0V$
$$\boxed{0=V_2+(V_1-V_2)\frac{R_2}{R_1+R_2}}$$
Como conocemos $V_1$ _(la saturacion del OpAmp que actua como comparador, osea la amplitud de la señal cuadrada)_ podemos calcular $V_2$, que es el pico de la onda triangular.

**Conclusion:** modificando $R_1$ y $R_2$ puedo cambar el pico de la onda a voluntad


**FRECUENCIA:**
Sabemos que el integrador genera una tension de salida de
$$\frac{1}{RC}\int V_{1}(t)dt=V_{2}(t)$$

![](https://i.imgur.com/sa95mXB.png =500x)
Como $V_1$ solo tiene dos valores posibles, lo tratamos como una constante, imaginemos que $V_1=5  \lor -5$


$$\boxed{\frac{1}{RC}5t=V_{2}}$$

Ademas, por el calculo de amplitud de onda triangular, sabemos que $V_2$ tendra un valor puntual que ya conoemos, entonces al conocer el tiempo $t$ que tarda el capacitor en llegar al pico conocemos el periodo $P$ y la frecuencia $f$ .
$$\boxed{P=2t}$$
$$\boxed{f=\frac{1}{2t}}$$

**Conclusion:** modificando la resistencia de carga de capacitor $R$ modifico la frecuencia







## Adecuadores de señal


### El  adaptador de rangos de tension
[fuente](https://www.youtube.com/watch?v=JHtEhRjygls&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=121)

Se trata de **una combinacion del amplificador inversor y el no inversor**. Permite transformar un rango de tensiones en otro

$$-10V\text{ a }10V \to \boxed{\text{Adecuador}}\to 0V \text{ a } 10V$$

Si superponemos **un amplificador** y un **amplificador inversor** obtenemos el siguiente circuito
![](https://i.imgur.com/HoPYEh0.png)
y al analizarlo por teorema de superposicion, nos queda que

$$1) \boxed{V_{out}=\frac{-R_2}{R_1}*V_{in}+V_1*\frac{R_1+R_2}{R_1}}$$

Vemos que nosotros queremos lograr una funcion que consuma como dominio $V_{in}=(-10;10)$ y tenga como imagen $V_{out}=(0;10)$ y que sea lineal, por ejemplo la recta
$$2) \boxed{V_{out}=5+0.5V_{in}}$$

Hay que lograr que $1)$ se transforme en $2)$ entonces 
$0.5=\frac{-R_2}{R_1}$
$5=V_1*\frac{R_1+R_2}{R_1}$

### Convertidor I-V con adecuacion
[fuente](https://www.youtube.com/watch?v=kSF_YRUGvAo&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=123)

Se trata de un circuito para transformar un **sensor** que funciona como **fuente de corriente** en una **tension proporcional a esa corriente** para poder analizar.

Consta de dos circuitos ya conocidos
* **Convertidor** $I-V$ 
	* Que transforma la corriente en una tension
* **Adaptador de rangos de tension**
	* Para adecuar la tension al rango que nos importa

$$4ma\text{ a }20ma \to \boxed{\text{convertidor I-V}}\to 4V \text{ a } 10V \to \boxed{\text{Adaptador}} \to 0V \text{ a }  10V$$

![](https://i.imgur.com/P05LPtb.png)

### Convertidor V-I / Howland current source
[fuente](https://www.youtube.com/watch?v=Z-CX5vyAzB0&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=125)
[fuente 2 - Motivacion, aplicacion](https://www.youtube.com/watch?v=DeDk0Rl3Oa0)
[fuente 3](https://www.youtube.com/watch?v=26jwvYAA4bg&t=508s)

Se trata de un circuito que transforma un rango de valores de corriente en tension

Muy usado cuando **tenes que transmitir informacion grandes distancias**, ya que la corriente no es susceptible a interferencia ni a caidas, pero la tension si.
![](https://i.imgur.com/WsgVswe.png)

El circuito es el siguiente:


[ejemplo](https://tinyurl.com/yzzx6jb4)
![](https://i.imgur.com/kFA7SZl.png)


**Funcionamiento:**

1) Como todos los resistores (salvo la carga $R_c$) son iguales
	* las corrientes $I_1$ e $I_2$ son iguales pq los resistores estan en serie
	* La corriente $I_3$ es igual a $I_2$ por que tienen el mismo valor de resistor y las mismas tensiones en ambos extremos
 
![](https://i.imgur.com/0rugjbo.png =400x)

2. por $KCL$ vemos que
* $I_5+I_4=I_3$
* 
* ![](https://i.imgur.com/QzKkioD.png =400x)

Reemplazando $I_4$
$I_5+\frac{V_a}{R_1}=I_3$
Recordando que $I_3=I_1$ y reeplazando
$I_5+\frac{V_a}{R_1}=I_1$
Reemplazando
$I_5+\frac{V_a}{R_1}=\frac{V_a-V_1}{R_1}$
Despejando
$$\boxed{I_5=-\frac{V_1}{R_1}}$$

Entonces la corriente $I_5$ que atraviesa la carga $R_c$ **no depende de la carga**. entonces tenemos una **fuente de corriente regulada por la tension de entrada** $R_1$

a
## Reguladores de control

### Control proporcional  - WIP
[FUENTE](https://www.youtube.com/watch?v=-xokd_mUi_I&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=104&t=109s)


### Control PI - WIP
[fuente](https://www.youtube.com/watch?v=ZCCHoljsRMg&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=113)

### Control PID - WIP
fuennte[enter link description here](https://www.youtube.com/watch?v=gR9TYcK5nzY&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=116)


# Integrados a base de OpAmps

##  TL431 - "Zener" ajustable de# precision

[Fuente](https://www.youtube.com/watch?v=ERiJ56brWoY)
Se trata de un shunt regulator (Como un zener) pero cuya tension de ruptura **se puede controlar con precision con una señal**, sirve para **generar una tension de referencia que vos quieras y es proporcional a una señal de entrada**

Generalmente permite hacer tensiones de referencia dentro del rango de $2.5V - 36V$

![](https://i.imgur.com/y79axDB.png)

El uso es bastate sencillo, se coloca un divisor de tension y la tension en paralelo al **Tl431** sera 

$$\large{\boxed{V_{out}=2.5V(1+\frac{R_1}{R_2})}}$$ 

![](https://i.imgur.com/fOlvYt9.png)

## LM311 - Comparador 


[fuente](https://www.youtube.com/watch?v=0ORvNa1jKiE&list=PLb_ph_WdlLDny2cGloFSxyRgO8B733jeo&index=117)
Se trata de un **comparador de tension** que compara sus dos pines de entrada y como resultado deja o no pasar la corriente desde el output hasta $V_{cc-}$ mediante un transistor que trae integrado


![](https://i.imgur.com/RJ9dJ0d.png)
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE4MzgwNjY3NjIsLTE2MTUxNjgyNDJdfQ
==
-->